---
layout: base
---

{%- assign root = page.url | replace: '/index.html','/' -%}

<header class="spec-header">
  <a class="back" href="{{ '/' | relative_url }}">← Back</a>
  <h1 class="spec-heading">{{ page.title }}</h1>
  <div class="spec-header-right">
    {%- if page.status -%}
      <span class="pill pill--{{ page.status | downcase }}">{{ page.status | capitalize }}</span>
    {%- endif -%}
    {%- if page.updated_at -%}
      <span class="pill pill--muted">Updated {{ page.updated_at }}</span>
    {%- endif -%}
    {%- if page.owner -%}
      <span class="pill">Owner {{ page.owner }}</span>
    {%- endif -%}
    {%- if page.team -%}
      <span class="pill">Team {{ page.team }}</span>
    {%- endif -%}
    {%- if page.created_at -%}
      <span class="pill">Created {{ page.created_at }}</span>
    {%- endif -%}
  </div>
</header>

{%- comment -%}
  Compute the “space” directory (…/specs/<name>/<version>/)
  Example: specs/flutter-sdk/v2/index.md  →  specs/flutter-sdk/v2/
{%- endcomment -%}
{%- assign parts = page.path | split:'/' -%}
{%- assign space_dir = parts | slice: 0, parts.size | join:'/' -%}
{%- assign space_dir = space_dir | replace: '/index.md','/' -%}
{%- assign space_docs = site.specs | where_exp:'d', "d.path contains space_dir" -%}

{%- comment -%}
  Keep only top-level files in the space (index.md and first-level pages).
  Also allow per-page front-matter:
    nav_order: 10
    nav_title: "High-Level Design"
{%- endcomment -%}
{%- assign nav_items = "" | split: "" -%}
{%- for d in space_docs -%}
  {%- assign depth = d.path | remove_first: space_dir | split:'/' | size -%}
  {%- if depth <= 1 -%}
    {%- assign nav_items = nav_items | push: d -%}
  {%- endif -%}
{%- endfor -%}
{%- assign nav_items = nav_items | sort: 'nav_order' -%}

<div class="spec-grid">
  <aside class="sidebar">
    <nav class="sidebar-nav">
      <ul>
        {%- for d in nav_items -%}
          {%- assign href = d.url | replace: '/index.html','/' -%}
          <li>
            <a class="{% if page.url == d.url %}active{% endif %}"
               href="{{ href | relative_url }}">
               {{ d.nav_title | default: d.title | default: 'Untitled' }}
            </a>
          </li>
        {%- endfor -%}
      </ul>
    </nav>
  </aside>

  <main class="content">
    <article class="content-card">
      {%- if page.status -%}
        <p class="muted"><strong>Status:</strong> <span class="pill pill--muted">{{ page.status | capitalize }}</span></p>
      {%- endif -%}

      {{ content }}
    </article>
  </main>
</div>
